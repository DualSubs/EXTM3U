// minify: https://www.digitalocean.com/community/tools/minify
export class EXTM3U{constructor(t){this.name="EXTM3U v0.7.1",this.opts=t,this.newLine=this.opts.includes("\n")?"\n":this.opts.includes("\r")?"\r":this.opts.includes("\r\n")?"\r\n":"\n"}parse(t=new String){const n=/^(?<TYPE>(?:EXT|AIV)[^#:]+):?(?<OPTION>.+)?[\r\n]?(?<URI>.+)?$/;let s=t.replace(/\r\n/g,"\n").split(/[\r\n]#/).map((t=>t.match(n)?.groups??t));return s=s.map((t=>(/=/.test(t?.OPTION)&&this.opts.includes(t.TYPE)&&(t.OPTION=Object.fromEntries(t.OPTION.split(/,(?=[A-Z])/).map((t=>t.split(/=(.*)/))))),t))),s}stringify(t=new Array){t?.[0]?.includes("#EXTM3U")||t.unshift("#EXTM3U");let n=t.map((t=>("object"==typeof t?.OPTION&&(t.OPTION=Object.entries(t.OPTION).map((t=>t.join("="))).join(",")),t?.URI?t.TYPE+":"+t.OPTION+this.newLine+t.URI:t?.OPTION?t.TYPE+":"+t.OPTION:t?.TYPE?t.TYPE:t)));return n=n.join(this.newLine+"#"),n}}
